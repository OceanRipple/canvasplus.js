!function(){"use strict";function t(t){this.canvas=t,this.context=t.getContext("2d"),this.width=t.width,this.height=t.height}window.Canvasplus||(window.Canvasplus=t)}(),function(t){"use strict";var n=10,e="rgba(0,0,0,1)";t.prototype.normalBrush=function(t,o){function a(t,n){s=!0,c=n}function r(n,o){s&&(u.save(),u.globalCompositeOperation="source-over",u.beginPath(),u.lineCap="round",u.lineJoin="round",u.moveTo(c.x,c.y),u.lineTo(o.x,o.y),u.lineWidth=t,u.strokeStyle=e,u.stroke(),u.restore(),c=o)}function i(t,n){s=!1,c=null}var h=this;t||(t=n),o||(o=e);var u=(h.canvas,h.context),s=!1,c=null;h.bindEvent("start",a),h.bindEvent("move",r),h.bindEvent("end",i)},t.prototype.pencil=function(t){function e(t,n){h=!0,u={x:Math.floor(n.x),y:Math.floor(n.y)}}function o(n,e){if(e={x:Math.floor(e.x),y:Math.floor(e.y)},h){for(var o=t/2,a=e.x-u.x,r=e.y-u.y,s=Math.sqrt(a*a+r*r),c=(Math.abs(a),Math.abs(r),a/s),d=r/s,v=0;s>v;v++)for(var f={x:u.x+v*c,y:u.y+v*d},l=-o;o>=l;l++){var p={x:f.x-l*d,y:f.y+l*c};i.save(),i.beginPath(),i.moveTo(p.x,p.y),i.lineTo(p.x+1,p.y),i.lineTo(p.x+1,p.y+1),i.lineTo(p.x,p.y+1),i.closePath();var y=Math.floor(100*Math.random())/100;i.fillStyle="rgba(0,0,0,{@randoma})".replace(/{@randoma}/,y),i.fill(),i.restore()}u=e}}function a(t,n){h=!1,u=null}var r=this;t||(t=n);var i=(r.canvas,r.context),h=!1,u=null;r.bindEvent("start",e),r.bindEvent("move",o),r.bindEvent("end",a)},t.prototype.bindEvent=function(t,n){var e,o,a,r=this;switch(t){case"start":e="mousedown",o="touchstart";break;case"move":e="mousemove",o="touchmove";break;case"end":e="mouseup",o="touchend"}r.canvas.addEventListener(e,function(t){a={x:t.clientX,y:t.clientY},n(t,r.posConvert(a))}),r.canvas.addEventListener(o,function(t){a={x:t.touches[0].clientX,y:t.touches[0].clientY},n(t,r.posConvert(a))})},t.prototype.posConvert=function(t){var n=this,e=n.canvas,o=e.getBoundingClientRect();return{x:t.x-o.left*(e.width/o.width),y:t.y-o.top*(e.height/o.height)}}}(Canvasplus),!function(t){function n(t){var n=t.width,e=t.height,o=t.data,a=[];if(o.constructor.name!==Uint8ClampedArray.name)throw"not a imagedata";for(var r=0;e>r;r++){var i=r*n*4;a.push(o.subarray(i,i+4*n))}return{width:n,height:e,data:a}}function e(t,n){if(t.length!==n.length)throw"error dot droduct";var e=t.reduce(function(t,e,o,a){return Number(t)+Number(e*n[o])},0);return e}function o(t){for(var n=[],e=0;e<4*t.width;e+=4){for(var o=[],a=0;a<t.height;a++)o.push(t.data[a][e]),o.push(t.data[a][e+1]),o.push(t.data[a][e+2]),o.push(t.data[a][e+3]);n.push(o)}return{data:n,width:t.height,height:t.width}}function a(t){for(var n=t.data,e=t.width,o=t.height,a=new Uint8ClampedArray(e*o*4),r=0;o>r;r++)for(var i=0;4*e>i;i++){var h=r*e*4+i;a[h]=n[r][i]}return new ImageData(a,e,o)}function r(t,n){n=o(n),mm=[];for(var a=0;a<t.height;a++){for(var r=[],i=0;i<n.height;i++)r.push(e(t.data[a],n.data[i]));mm.push(r)}return{data:mm,width:n.height,height:t.height}}function i(t){return a(o(n(t)))}Uint8ClampedArray.prototype.reduce=function(t,n){var e=this,o=n,a=0;if("undefined"===o&&(o=e[0],a=1),"function"==typeof t)for(a;a<e.length;a++)e.hasOwnProperty(a)&&(o=t(o,e[a],a,e));return o},Uint8ClampedArray.prototype.map=function(t,n){var e=new Uint8ClampedArray(this.length);if("function"==typeof t)for(var o=0,a=this.length;a>o;o++)e[o]=fn.call(n,this[o],o,this);return e},t.prototype.matrix=n,t.prototype.mxm=r,t.prototype.flat=a,t.prototype.trans=o,t.prototype.rotate90=i}(Canvasplus);